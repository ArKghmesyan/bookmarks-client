(this["webpackJsonpbookmarks-client"]=this["webpackJsonpbookmarks-client"]||[]).push([[0],{297:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(25),o=n.n(c),s=n(28),i=n(307),l=n(311),u=n(312),d=n(180),j=n(32),b=n(308),f=n(313),m=n(300),O=n(301),p=n(309),h=n(303),x=n(186),g=n(318),v=n(185),y=n(187),k=n(130),w=n(184),C=n(167),T=n(168),S=n.n(T).a.create({baseURL:"https://api.bookmarks.am/api"}),I=n(123),P=n(29);function z(e,t){switch(t.type){case"drop":return Object(P.a)(Object(P.a)({},e),{},{page:1,total:0,docs:[]});case"list":return Object(P.a)(Object(P.a)({},e),t.payload);case"getTags":return Object(P.a)(Object(P.a)({},e),{},{tags:t.payload});case"add":return Object(P.a)(Object(P.a)({},e),{},{docs:[t.payload].concat(Object(I.a)(e.docs))});case"remove":return Object(P.a)(Object(P.a)({},e),{},{docs:e.docs.filter((function(e){return e._id!==t.payload._id}))});case"update":return Object(P.a)(Object(P.a)({},e),{},{docs:e.docs.map((function(e){return e._id===t.payload._id?t.payload:e}))});case"bulkRemove":return Object(P.a)(Object(P.a)({},e),{},{docs:e.docs.filter((function(e){return!t.payload.ids.includes(e._id)}))});case"bulkUpdate":return Object(P.a)(Object(P.a)({},e),{},{docs:e.docs.map((function(e){return t.payload.ids.includes(e._id)?Object.assign({},e,t.payload.data):e}))});default:throw new Error("".concat(t.type," not found!"))}}var B=n(6),E=Object(a.createContext)();function F(e){var t=e.children,n=function(){var e=Object(a.useReducer)(z,R),t=Object(s.a)(e,2),n=t[0],r=t[1];return{data:n,bulkRemove:function(e){return S.post("/bookmarks/bulk/delete",{ids:e}).then((function(){return r({type:"bulkRemove",payload:{ids:e}})})).catch((function(e){d.b.error(e.message)}))},bulkUpdate:function(e,t){return S.post("/bookmarks/bulk/update",{ids:e,data:t}).then((function(){return r({type:"bulkUpdate",payload:{ids:e,data:t}})})).catch((function(e){d.b.error(e.message)}))},getTags:function(){return S.get("/bookmarks/tags").then((function(e){return r({type:"getTags",payload:e.data})})).catch((function(e){d.b.error(e.message)}))},drop:function(){return S.delete("/bookmarks/").then((function(){return r({type:"drop"})})).catch((function(e){d.b.error(e.message)}))},add:function(e){return S.post("/bookmarks",e).then((function(e){return r({type:"add",payload:e.data})})).catch((function(e){d.b.error(e.message)}))},list:function(e){return S.get("/bookmarks",{params:e}).then((function(e){return r({type:"list",payload:e.data})})).catch((function(e){d.b.error(e.message)}))},update:function(e,t){return S.put("/bookmarks/".concat(e),t).then((function(e){return r({type:"update",payload:e.data})})).catch((function(e){d.b.error(e.message)}))},remove:function(e){return S.delete("/bookmarks/".concat(e)).then((function(){return r({type:"remove",payload:{_id:e}})})).catch((function(e){d.b.error(e.message)}))}}}();return Object(B.jsx)(E.Provider,{value:n,children:t})}function U(){return Object(a.useContext)(E)}var R={limit:0,total:0,tags:[],docs:[],page:1};var A=n(305),_=n(122),L=n(97),N=n(314),q=n(315);function Y(e){var t=Object(a.useState)(e.value),n=Object(s.a)(t,2),r=n[0],c=n[1],o=Object(a.useState)(!1),i=Object(s.a)(o,2),u=i[0],d=i[1],j=Object(a.useState)(""),b=Object(s.a)(j,2),f=b[0],m=b[1],O=Object(a.useRef)();Object(a.useEffect)((function(){e.onChange(r)}),[r]),Object(a.useEffect)((function(){var e;null===O||void 0===O||null===(e=O.current)||void 0===e||e.focus()}),[u]);var h=function(){f&&-1===r.indexOf(f)&&c([].concat(Object(I.a)(r),[f])),d(!1),m("")};return Object(B.jsxs)(B.Fragment,{children:[r.map((function(e){return Object(B.jsx)(l.a,{closable:!0,onClose:function(){return c(r.filter((function(t){return t!==e})))},children:e},e)})),u&&Object(B.jsx)(p.a,{ref:O,type:"text",size:"small",style:{width:"78px",marginRight:"8px",verticalaAign:"top"},value:f,onChange:function(e){return m(e.target.value)},onBlur:h,onPressEnter:h}),!u&&Object(B.jsxs)(l.a,{style:{background:"#fff",borderStyle:"dashed"},onClick:function(){return d(!0)},children:[Object(B.jsx)(w.a,{})," New Tag"]})]})}function H(e){var t,n=A.a.useForm(),r=Object(s.a)(n,1)[0],c=Object(a.useState)(""),o=Object(s.a)(c,2),i=o[0],l=o[1],u=Object(a.useState)(!1),d=Object(s.a)(u,2),j=d[0],f=d[1],m=!(null===(t=e.record)||void 0===t?void 0:t._id);Object(a.useEffect)((function(){var t;r.setFieldsValue(e.record),l(null===(t=e.record)||void 0===t?void 0:t.type)}),[e.record,r]);return Object(B.jsx)(b.a,{title:m?"Add Bookmark":"Edit Bookmark",visible:!!e.record,onCancel:function(){return e.onCancel()},onOk:function(){return r.submit()},okText:"Submit",confirmLoading:j,destroyOnClose:!0,children:Object(B.jsxs)(A.a,{form:r,preserve:!1,layout:"vertical",onFinish:function(t){f(!0),m?e.onCreate(t).finally((function(t){return f(!1),e.onCancel(),t})):e.onUpdate(e.record._id,t).finally((function(t){return f(!1),e.onCancel(),t}))},children:[Object(B.jsx)(A.a.Item,{name:"type",style:{textAlign:"center"},children:Object(B.jsxs)(_.a.Group,{value:i,onChange:function(e){return l(e.target.value)},children:[Object(B.jsxs)(_.a.Button,{value:"site",children:[Object(B.jsx)(N.a,{})," Website"]}),Object(B.jsxs)(_.a.Button,{value:"book",children:[Object(B.jsx)(q.a,{})," Book"]})]})}),Object(B.jsx)(A.a.Item,{name:"name",label:"Name",rules:[{required:!0}],children:Object(B.jsx)(p.a,{placeholder:"6pm"})}),"book"===i&&Object(B.jsx)(A.a.Item,{name:"page",label:"Page",children:Object(B.jsx)(p.a,{placeholder:"14"})}),Object(B.jsx)(A.a.Item,{name:"url",label:"URL",rules:[{required:"site"===i}],children:Object(B.jsx)(p.a,{placeholder:"https://6pm.com"})}),Object(B.jsx)(A.a.Item,{name:"favorite",valuePropName:"checked",children:Object(B.jsx)(L.a,{children:"Favorite (Show First)"})}),Object(B.jsx)(A.a.Item,{name:"tags",label:"Tags",children:Object(B.jsx)(Y,{})}),Object(B.jsx)(A.a.Item,{name:"notes",label:"Notes",children:Object(B.jsx)(p.a.TextArea,{placeholder:"Please don't write your password!"})})]})})}function D(e){var t=A.a.useForm(),n=Object(s.a)(t,1)[0],r=Object(a.useState)(!1),c=Object(s.a)(r,2),o=c[0],i=c[1];return Object(B.jsx)(b.a,{title:"Update Bookmarks",visible:e.visible,onCancel:function(){return e.onCancel()},onOk:function(){return n.submit()},okText:"Submit",confirmLoading:o,destroyOnClose:!0,children:Object(B.jsx)(A.a,{form:n,preserve:!1,layout:"vertical",onFinish:function(t){i(!0),e.onUpdate(e.selectedIds,t).finally((function(t){return i(!1),e.onCancel(),t}))},children:Object(B.jsx)(A.a.Item,{name:"tags",label:"Tags",initialValue:[],children:Object(B.jsx)(Y,{})})})})}function M(e){var t=e.record;if(t.url){var n="example.com";try{n=new URL(t.url).hostname}catch(a){}return Object(B.jsxs)("a",{href:t.url,target:"_blank",rel:"noreferrer",children:[Object(B.jsx)("img",{style:{marginRight:8},alt:"Logo",width:"16",src:"https://www.google.com/s2/favicons?domain=".concat(n)}),t.name]})}return Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(q.a,{style:{marginRight:8}}),t.name]})}var V=n(316),J=n(317);function K(e){var t=e.record,n=e.onClick;return t.favorite?Object(B.jsx)(V.a,{onClick:function(){return n(Object(P.a)(Object(P.a)({},t),{},{favorite:!1}))},style:{color:"#eec35d",fontSize:16}}):Object(B.jsx)(J.a,{onClick:function(){return n(Object(P.a)(Object(P.a)({},t),{},{favorite:!0}))},style:{color:"#e6e2da",fontSize:16}})}var W=n(172),G=n.n(W),Q=i.a.Text;function X(){var e,t,n=Object(a.useState)(null),r=Object(s.a)(n,2),c=r[0],o=r[1],i=Object(a.useState)(1),T=Object(s.a)(i,2),S=T[0],I=T[1],P=Object(a.useState)(!1),z=Object(s.a)(P,2),E=z[0],F=z[1],R=Object(a.useState)(!1),A=Object(s.a)(R,2),_=A[0],L=A[1],N=Object(a.useState)([]),q=Object(s.a)(N,2),Y=q[0],V=q[1],J=Object(a.useState)(""),W=Object(s.a)(J,2),X=W[0],Z=W[1],$=U(),ee=Object(a.useCallback)(function(e,t,n){var a;return function(){var r=this,c=arguments,o=function(){a=null,n||e.apply(r,c)},s=n&&!a;clearTimeout(a),a=setTimeout(o,t),s&&e.apply(r,c)}}((function(e){return E||F(!0),$.list(e).finally((function(e){return F(!1),e}))}),300),[]);Object(a.useEffect)((function(){1!==S&&I(1),ee({search:X,page:1})}),[X]),Object(a.useEffect)((function(){ee({search:X,page:S})}),[S]),Object(a.useEffect)((function(){$.getTags()}),[]);var te=Object(a.useMemo)((function(){return[{title:"",width:40,align:"center",dataIndex:"favorite",key:"favorite",render:function(e,t){return Object(B.jsx)(K,{record:t,onClick:function(e){return $.update(t._id,e)}})}},{title:"Name",dataIndex:"name",key:"name",render:function(e,t){return Object(B.jsx)(M,{record:t})}},{title:"Notes",dataIndex:"notes",key:"notes"},{title:"Tags",key:"tags",dataIndex:"tags",render:function(e){return null===e||void 0===e?void 0:e.map((function(e){return Object(B.jsx)(l.a,{color:"geekblue",onClick:function(){return Z(e)},children:e},e)}))}},{title:"",key:"action",align:"right",render:function(e,t){return Object(B.jsxs)(u.b,{children:[!!t.url&&Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(C.CopyToClipboard,{text:t.url,onCopy:function(){return d.b.success("Copied.")},children:Object(B.jsx)(j.a,{size:"small",icon:Object(B.jsx)(x.a,{})})}),Object(B.jsx)(j.a,{size:"small",icon:Object(B.jsx)(g.a,{}),onClick:function(){return b.a.info({icon:null,width:350,content:Object(B.jsx)(G.a,{size:"142",value:t.url})})}})]}),Object(B.jsx)(j.a,{size:"small",onClick:function(){return o(t)},icon:Object(B.jsx)(v.a,{})}),Object(B.jsx)(f.a,{okText:"Yes",cancelText:"No",destroyTooltipOnHide:!0,okButtonProps:{danger:!0},title:"Are you sure you want to delete this bookmark?",onConfirm:function(){return $.remove(t._id)},children:Object(B.jsx)(j.a,{size:"small",icon:Object(B.jsx)(y.a,{})})})]})}}]}));return Object(B.jsxs)("div",{children:[Object(B.jsx)(H,{onCancel:function(){return o(null)},onUpdate:$.update,onCreate:$.add,record:c}),Object(B.jsx)(D,{visible:_,selectedIds:Y,onCancel:function(){V([]),L(!1)},onUpdate:function(e,t){return $.bulkUpdate(e,t).then((function(e){return V([]),L(!1),e}))}}),Object(B.jsxs)(m.a,{style:{marginBottom:20},wrap:!1,children:[Object(B.jsx)(O.a,{flex:"auto",children:Object(B.jsx)(p.a,{bordered:!0,allowClear:!0,size:"large",value:X,placeholder:"Type name, tag, link...",prefix:Object(B.jsx)(k.a,{}),onChange:function(e){return Z(e.target.value)}})}),Object(B.jsx)(O.a,{flex:"none",style:{paddingLeft:20},children:Object(B.jsx)(j.a,{icon:Object(B.jsx)(w.a,{}),size:"large",type:"primary",onClick:function(){return o({type:"site",tags:[]})},children:"Add Bookmark"})})]}),(null===(e=$.data)||void 0===e||null===(t=e.tags)||void 0===t?void 0:t.length)>0&&Object(B.jsx)("div",{style:{marginBottom:20},children:Object(B.jsxs)(u.b,{wrap:!0,children:[Object(B.jsx)(Q,{children:"Filter By:"}),$.data.tags.map((function(e){return Object(B.jsxs)(j.a,{size:"small",onClick:function(){return Z(e)},type:X===e?"primary":"dashed",children:["#",e]},e)}))]})}),Y.length>1&&Object(B.jsxs)(u.b,{style:{marginBottom:20},children:[Object(B.jsxs)(j.a,{size:"middle",type:"primary",icon:Object(B.jsx)(v.a,{}),onClick:function(){return L(!0)},children:["Edit ",Y.length," Items"]}),Object(B.jsx)(f.a,{okText:"Yes",cancelText:"No",destroyTooltipOnHide:!0,okButtonProps:{danger:!0},title:"Are you sure you want to delete the selected bookmarks? ",onConfirm:function(){return $.bulkRemove(Y)},children:Object(B.jsxs)(j.a,{size:"middle",type:"primary",danger:!0,icon:Object(B.jsx)(y.a,{}),children:["Delete ",Y.length," Items"]})})]}),Object(B.jsx)(h.a,{loading:E,columns:te,dataSource:$.data.docs,onChange:function(e){var t=e.current;return I(t)},rowKey:"_id",pagination:{current:S,showSizeChanger:!1,total:$.data.total,pageSize:$.data.limit},rowSelection:{onChange:V,selectedRowKeys:Y},size:"small",scroll:{x:1},style:{whiteSpace:"nowrap"}})]})}var Z=n(306),$=n(310),ee=n(176),te=Object(a.createContext)();function ne(e){var t=e.children,n=function(){var e=Object($.a)(["user"]),t=Object(s.a)(e,3),n=t[0],r=t[1],c=t[2],o=Object(a.useState)(null),i=Object(s.a)(o,2),l=i[0],u=i[1];return Object(a.useEffect)((function(){var e={exp:0};try{var t;e=Object(ee.a)(null===(t=n.user)||void 0===t?void 0:t.accessToken)}catch(o){}var a=(new Date).getTime()/1e3;if(e.exp>a){var r,c="Bearer ".concat(null===(r=n.user)||void 0===r?void 0:r.accessToken);S.defaults.headers.common.Authorization=c,u(n.user)}else S.defaults.headers.common.Authorization=void 0,u(null)}),[]),{user:l,signin:function(e){return S.post("/auth/login",{email:e.email,password:e.password}).then((function(e){var t="Bearer ".concat(e.data.accessToken);S.defaults.headers.common.Authorization=t,u(e.data),r("user",e.data,{path:"/"})})).catch((function(e){d.b.error(e.message)}))},signup:function(e){return S.post("/auth/register",{email:e.email,password:e.password}).then((function(e){var t="Bearer ".concat(e.data.accessToken);S.defaults.headers.common.Authorization=t,u(e.data),r("user",e.data,{path:"/"})})).catch((function(e){d.b.error(e.message)}))},signout:function(){c("user"),u(null)}}}();return Object(B.jsx)(te.Provider,{value:n,children:t})}function ae(){return Object(a.useContext)(te)}var re=n(319),ce=n(320);function oe(e){return Object(B.jsxs)(A.a,{layout:"vertical",style:{backgroundColor:"#fff",padding:20,marginTop:"-16px"},onFinish:function(t){return e.onFinish(t)},children:[Object(B.jsx)(A.a.Item,{name:"email",rules:[{type:"email",message:"The input is not valid E-mail!"},{required:!0,message:"Please input your E-mail!"}],children:Object(B.jsx)(p.a,{placeholder:"Email",prefix:Object(B.jsx)(re.a,{})})}),Object(B.jsx)(A.a.Item,{name:"password",rules:[{required:!0,message:"Please input your password!"}],children:Object(B.jsx)(p.a.Password,{placeholder:"Password",prefix:Object(B.jsx)(ce.a,{}),type:"password"})}),Object(B.jsx)(A.a.Item,{children:Object(B.jsx)(j.a,{type:"primary",htmlType:"submit",children:"Sign In"})})]})}function se(e){return Object(B.jsxs)(A.a,{layout:"vertical",style:{backgroundColor:"#fff",padding:20,marginTop:"-16px"},onFinish:function(t){return e.onFinish(t)},children:[Object(B.jsx)(A.a.Item,{name:"email",rules:[{type:"email",message:"The input is not valid E-mail!"},{required:!0,message:"Please input your E-mail!"}],children:Object(B.jsx)(p.a,{placeholder:"Email",prefix:Object(B.jsx)(re.a,{})})}),Object(B.jsx)(A.a.Item,{name:"password",rules:[{required:!0,message:"Please input your password!"}],children:Object(B.jsx)(p.a.Password,{placeholder:"Password",prefix:Object(B.jsx)(ce.a,{})})}),Object(B.jsx)(A.a.Item,{name:"confirm",dependencies:["password"],rules:[{required:!0,message:"Please confirm your password!"},function(e){var t=e.getFieldValue;return{validator:function(e,n){return n&&t("password")!==n?Promise.reject(new Error("The two passwords that you entered do not match!")):Promise.resolve()}}}],children:Object(B.jsx)(p.a.Password,{placeholder:"Confirm Password",prefix:Object(B.jsx)(ce.a,{})})}),Object(B.jsx)(A.a.Item,{children:Object(B.jsx)(j.a,{type:"primary",htmlType:"submit",children:"Sign Up"})})]})}var ie=i.a.Title,le=Z.a.TabPane;function ue(){var e=ae();return Object(B.jsxs)("div",{children:[Object(B.jsx)(ie,{level:2,style:{marginBottom:25},children:"Sign In to Save Your Bookmarks!"}),Object(B.jsx)("div",{style:{overflow:"hidden",maxWidth:500},children:Object(B.jsxs)(Z.a,{type:"card",children:[Object(B.jsx)(le,{tab:"Sign In",children:Object(B.jsx)(oe,{onFinish:function(t){return e.signin(t)}})},"1"),Object(B.jsx)(le,{tab:"Sign Up",children:Object(B.jsx)(se,{onFinish:function(t){return e.signup(t)}})},"2")]})})]})}var de=n(302),je=n(124),be=n(75),fe=n(304),me=n(133);var Oe=function(){var e,t=ae(),n=U(),r=Object(a.useRef)({});return t.user&&Object(B.jsx)(je.a,{overlay:Object(B.jsxs)(be.a,{children:[Object(B.jsx)(be.a.Item,{children:Object(B.jsx)(fe.a,{name:"bookmarks",multiple:!1,showUploadList:!1,accept:"application/html, text/html",action:S.defaults.baseURL.concat("/bookmarks/import"),headers:{authorization:S.defaults.headers.common.Authorization},onChange:function(e){"done"===e.file.status?(d.b.success("Your bookmarks imported successfully!"),n.list(),r.current.uploading=!1):"error"===e.file.status?(d.b.error("Your bookmarks import failed!"),r.current.uploading=!1):"uploading"===e.file.status&&(r.current.uploading||d.b.info("Please wait!"),r.current.uploading=!0)},children:"Import Bookmarks HTML"})}),Object(B.jsx)(be.a.Item,{onClick:function(){return b.a.confirm({title:"Are you sure to want to delete your bookmarks?",okButtonProps:{danger:!0},onOk:n.drop,okText:"Yes",cancelText:"No"})},children:"Delete Bookmarks"}),Object(B.jsx)(be.a.Item,{onClick:function(){return t.signout()},children:"Logout"})]}),children:Object(B.jsxs)("a",{style:{color:"#fff"},onClick:function(e){return e.preventDefault()},children:[null===(e=t.user)||void 0===e?void 0:e.email," ",Object(B.jsx)(me.a,{})]})})};d.b.config({});var pe=function(){var e=ae();return Object(B.jsxs)(de.a,{style:{minHeight:"100vh"},children:[Object(B.jsx)(de.a.Header,{children:Object(B.jsxs)(m.a,{wrap:!1,children:[Object(B.jsx)(O.a,{flex:"auto",children:Object(B.jsx)(q.a,{style:{fontSize:20,color:"#fff"}})}),Object(B.jsx)(O.a,{flex:"none",children:Object(B.jsx)(Oe,{})})]})}),Object(B.jsx)(de.a.Content,{style:{padding:"50px 5%"},children:e.user?Object(B.jsx)(X,{}):Object(B.jsx)(ue,{})})]})};n(296);o.a.render(Object(B.jsx)(r.a.StrictMode,{children:Object(B.jsx)(ne,{children:Object(B.jsx)(F,{children:Object(B.jsx)(pe,{})})})}),document.getElementById("root"))}},[[297,1,2]]]);
//# sourceMappingURL=main.7d9b3ce2.chunk.js.map